create or replace TABLE D_BRONZE.AZURE.TRAIN_PRODUCTIVITY_CPKC_GTM_TRN_FACT (
	RECEIVING_DT DATE NOT NULL,
	TITAN_NBR NUMBER(38,0) NOT NULL,
	TRAIN_NAME VARCHAR(13) NOT NULL,
	SRC_SYS VARCHAR(4) NOT NULL,
	DEPART_FSAC VARCHAR(10) NOT NULL,
	ARRIVE_FSAC VARCHAR(10) NOT NULL,
	EST_ARRIVAL_TMSTMP TIMESTAMP_NTZ(9) NOT NULL,
	ACTL_ARR_DT TIMESTAMP_NTZ(9) NOT NULL,
	EST_DEP_TMSTMP TIMESTAMP_NTZ(9) NOT NULL,
	ACTL_DEP_DT TIMESTAMP_NTZ(9) NOT NULL,
	RLCAR_EMPTY_CNT NUMBER(38,0),
	RLCAR_LOAD_CNT NUMBER(38,0),
	LIVE_LOCO_CNT NUMBER(38,0) NOT NULL,
	DH_LOCO_CNT NUMBER(38,0) NOT NULL,
	EQP_CONTENT_WGT NUMBER(38,0),
	DH_LOCO_TARE_TNS NUMBER(38,0),
	LIVE_LOCO_TARE_TNS NUMBER(38,0) NOT NULL,
	EQP_GROSS_WGT NUMBER(38,0) NOT NULL,
	MILES NUMBER(38,0) NOT NULL,
	TRN_LGTH NUMBER(38,0),
	LIVE_LOCO_FT NUMBER(38,0),
	DH_LOCO_FT NUMBER(38,0),
	LIVE_LOCO_HP NUMBER(38,0),
	DH_LOCO_HP NUMBER(38,0),
	ORG_STN_IND VARCHAR(1),
	DEST_STN_IND VARCHAR(1),
	ORG_STN_TRN_SCHD_CURR_NBR NUMBER(38,0) NOT NULL,
	DST_STN_TRN_SCHD_CURR_NBR NUMBER(38,0) NOT NULL,
	ETL_CREATED_TIME TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP(),
	ETL_UPDATED_TIME TIMESTAMP_NTZ(9),
	ORG_STN_TRN_SCHD_SEQ_NBR NUMBER(38,0),
	DST_STN_TRN_SCHD_SEQ_NBR NUMBER(38,0),
	primary key (TITAN_NBR, SRC_SYS, TRAIN_NAME, ORG_STN_TRN_SCHD_CURR_NBR, DST_STN_TRN_SCHD_CURR_NBR, DEPART_FSAC, ARRIVE_FSAC)
);

create or replace TABLE D_BRONZE.AZURE.TRAIN_PRODUCTIVITY_CPKC_TRAIN_DELAY (
	SRC_SYS VARCHAR(4) NOT NULL,
	TRN_ID VARCHAR(13) NOT NULL,
	PLAN_DEP_DT DATE NOT NULL,
	TRN_SCHD_CURR_NBR NUMBER(38,0) NOT NULL,
	FSAC VARCHAR(5) NOT NULL,
	TRN_NBR NUMBER(38,0) NOT NULL,
	TRN_SCHED_SEQ_NBR NUMBER(38,0) NOT NULL,
	CREATE_TMSTMP VARCHAR(30) NOT NULL,
	DELAY_RSN_TYP_CD VARCHAR(4) NOT NULL,
	EST_DEP_TMSTMP TIMESTAMP_NTZ(9) NOT NULL,
	DELAY_MNT_CNT NUMBER(38,0) NOT NULL,
	SCHED_DELAY_IND VARCHAR(1) NOT NULL,
	LAST_UPDT_TMSTMP TIMESTAMP_NTZ(9) NOT NULL,
	DEP_ANCHR_IND VARCHAR(1) NOT NULL,
	OPER_STN_NBR NUMBER(38,0) NOT NULL,
	TRN_SCHD_DELY_CMNT VARCHAR(512) NOT NULL,
	ETL_CREATED_TIME TIMESTAMP_NTZ(9) NOT NULL DEFAULT CURRENT_TIMESTAMP(),
	ETL_UPDATED_TIME TIMESTAMP_NTZ(9) NOT NULL,
	CREATE_USERID VARCHAR(8) NOT NULL DEFAULT '',
	LAST_UPDT_USERID VARCHAR(8) NOT NULL DEFAULT '',
	DEL_FLG VARCHAR(1),
	constraint PK_CPKC_TRAIN_DELAY primary key (SRC_SYS, TRN_NBR, TRN_SCHED_SEQ_NBR, TRN_SCHD_CURR_NBR, CREATE_TMSTMP)
);


create or replace TABLE D_BRONZE.AZURE.TRAIN_PRODUCTIVITY_KCS_STATIONS (
	ASSET_CD VARCHAR(4),
	SCAC_CD VARCHAR(4),
	FSAC_CD VARCHAR(5),
	SBDVSN_NM VARCHAR(80),
	CNTRY_CD VARCHAR(2),
	STN_NM VARCHAR(80),
	MILES NUMBER(10,3),
	KCS_SCAC_CD VARCHAR(4),
	KCS_FSAC_CD VARCHAR(5),
	EDW_CREATE_USER VARCHAR(20),
	EDW_CREATE_TMS TIMESTAMP_NTZ(9),
	EDW_UPDATE_USER VARCHAR(20),
	EDW_UPDATE_TMS TIMESTAMP_NTZ(9),
	EDW_ROW_SRC VARCHAR(200)
);