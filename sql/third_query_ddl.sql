Query_3_  DM_BMR.BMR_FACT_CNST_MVMNT (Output of Query_2 â€“ Input for Query_3):
Step _ 4 DM_BMR.BMR_FACT_CNST_MVMNT(Code-3)

dm_bmr.bmr_fact_cnst_mvmnt fct,
dm_bmr.mvmnt_cnst_event_prcs stg,
atm_train.train_cnst_dtl_rail_eqpt
dm_dim.dim_locomotive
dm_dim.dim_equipment


CREATE TABLE [DM_BMR].[BMR_FACT_CNST_MVMNT](
	[FACT_CNST_MVMNT_ID] [decimal](18, 0) NOT NULL,
	[EDW_CREATE_USER] [varchar](8) NULL,
	[EDW_CREATE_TMS] [datetime2](7) NULL,
	[EDW_UPDATE_USER] [varchar](8) NULL,
	[EDW_UPDATE_TMS] [datetime2](7) NOT NULL,
	[DIM_TRAIN_ID] [decimal](18, 0) NULL,
	[DIM_LOCOMOTIVE_ID] [decimal](18, 0) NULL,
	[DIM_DEPARTURE_LCTN_ID] [decimal](18, 0) NULL,
	[DIM_ARRIVAL_LCTN_ID] [decimal](18, 0) NULL,
	[DIM_EQUIPMENT_ID] [decimal](18, 0) NULL,
	[DIM_ORIGIN_LCTN_ID] [decimal](18, 0) NULL,
	[DIM_DSTNTN_LCTN_ID] [decimal](18, 0) NULL,
	[DIM_SHPR_CSTMR_ID] [decimal](18, 0) NULL,
	[DIM_CNSGN_CSTMR_ID] [decimal](18, 0) NULL,
	[DIM_COMMODITY_ID] [decimal](18, 0) NULL,
	[DIM_ORG_DST_PAIR_MLG_ID] [decimal](18, 0) NULL,
	[CONSIST_NBR] [decimal](18, 0) NULL,
	[DEPARTURE_TMS] [datetime2](7) NULL,
	[DEPARTURE_TIME_ZONE] [varchar](3) NULL,
	[ARRIVAL_TMS] [datetime2](7) NOT NULL,
	[ARRIVAL_TIME_ZONE] [varchar](3) NULL,
	[CONSIST_SQNC] [decimal](3, 0) NULL,
	[TARE_TONS] [decimal](18, 2) NULL,
	[CONTENT_TONS] [decimal](18, 2) NULL,
	[LCMTV_LEAD_TRAIL_IND] [varchar](2) NULL,
	[WYBL_TMS] [datetime2](7) NULL,
	[WYBL_NBR] [decimal](18, 0) NULL,
	[RECIEVE_FROM_SCAC] [varchar](5) NULL,
	[DELIVER_TO_SCAC] [varchar](5) NULL,
	[WYBL_WEIGHT] [decimal](18, 2) NULL,
	[PREPAID_IND] [varchar](1) NULL,
	[DIM_ARRIVAL_DT_ID] [decimal](18, 0) NULL,
	[SADB_RECEIVING_DT] [datetime2](7) NULL,
	[EDW_RECEIVING_DT] [datetime2](7) NULL,
	[DIM_SADB_RECEIVING_DT_ID] [decimal](18, 0) NULL,
	[DIM_EDW_RECEIVING_DT_ID] [decimal](18, 0) NULL,
	[LOAD_EMPTY_IND] [varchar](1) NULL,
	[MARK_CD] [varchar](4) NOT NULL,
	[EQPUN_NBR] [varchar](10) NOT NULL,
	[TRAIN_NM] [varchar](8) NOT NULL,
	[ROW_SOURCE] [varchar](100) NULL,
	[DIM_GIS_ORG_DST_PAIR_MLG_ID] [decimal](18, 0) NULL,
	[CPR_EQPMT_POOL_ID] [varchar](7) NULL,
	[DEPARTURE_EST_TMS] [datetime2](7) NULL,
	[ARRIVAL_EST_TMS] [datetime2](7) NULL,
 CONSTRAINT [BMR_FACT_CNST_MVMNT_PK] PRIMARY KEY CLUSTERED 
(
	[FACT_CNST_MVMNT_ID] ASC,
	[ARRIVAL_TMS] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [DM_BMR_BMR_FACT_CNST_MVMNT_PS]([ARRIVAL_TMS])
) ON [DM_BMR_BMR_FACT_CNST_MVMNT_PS]([ARRIVAL_TMS])
GO


DM_BMR.MVMNT_CNST_EVENT_PRCS:

dm_bmr.mvmnt_cnst_event_prcs stg,

CREATE TABLE [DM_BMR].[MVMNT_CNST_EVENT_PRCS](
	[EDW_CREATE_USER] [varchar](8) NULL,
	[EDW_CREATE_TMS] [datetime2](7) NULL,
	[EDW_UPDATE_USER] [varchar](8) NULL,
	[EDW_UPDATE_TMS] [datetime2](7) NULL,
	[MVMNT_TYPE] [char](5) NOT NULL,
	[RUN_NBR] [varchar](3) NULL,
	[MARK_CD] [varchar](4) NOT NULL,
	[EQPUN_NBR] [varchar](10) NOT NULL,
	[LOAD_EMPTY_IND] [varchar](1) NULL,
	[CYCLE_SERIAL_NBR] [decimal](18, 0) NULL,
	[TRAIN_NM] [varchar](8) NULL,
	[SOURCE_SYSTEM_TRAIN_CNST_NBR] [varchar](4) NULL,
	[LEAD_LCMTV_MARK_CD] [varchar](4) NULL,
	[LEAD_LCMTV_EQPUN_NBR] [varchar](10) NULL,
	[AAR_STNDRD_EVENT_CD] [varchar](4) NULL,
	[REPORT_TMS] [datetime2](7) NOT NULL,
	[REPORT_TIME_ZONE] [varchar](2) NULL,
	[FSAC_CD] [varchar](5) NULL,
	[OFFLINE_SCAC_CD] [varchar](4) NULL,
	[CNST_ORIGIN_SCAC_CD] [varchar](4) NULL,
	[CNST_ORIGIN_FSAC_CD] [varchar](5) NULL,
	[CNST_DSTNTN_SCAC_CD] [varchar](4) NULL,
	[CNST_DSTNTN_FSAC_CD] [varchar](5) NULL,
	[TITAN_NBR] [varchar](40) NULL,
	[TYES_TRAIN_ID] [decimal](18, 0) NULL,
	[LAST_RPRTD_EVENT_TMS] [datetime2](7) NULL,
	[LAST_RPRTD_RPRTNG_TM_ZN_CD] [varchar](2) NULL,
	[TRAIN_CNST_SMRY_ID] [decimal](18, 0) NULL,
	[TRAIN_CNST_SMRY_VRSN_NBR] [decimal](4, 0) NULL,
	[MAX_TRAIN_CNST_SMRY_ID] [decimal](18, 0) NULL,
	[MAX_TRAIN_CNST_SMRY_VRSN_NBR] [decimal](18, 0) NULL,
	[SADB_RECEIVING_DT] [datetime2](7) NULL,
	[EDW_RECEIVING_DT] [datetime2](7) NULL,
	[REPORT_EST_TMS] [datetime2](7) NOT NULL,
	[EVENT_ID] [decimal](18, 0) NOT NULL,
 CONSTRAINT [MVMNT_CNST_EVENT_PRCS_PK] PRIMARY KEY CLUSTERED 
(
	[EVENT_ID] ASC,
	[MVMNT_TYPE] ASC,
	[REPORT_EST_TMS] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [DM_BMR_MVMNT_CNST_EVENT_PRCS_PS]([REPORT_EST_TMS])
) ON [DM_BMR_MVMNT_CNST_EVENT_PRCS_PS]([REPORT_EST_TMS])
GO


TRAIN_CNST_DTL_RAIL_EQPT:

atm_train.train_cnst_dtl_rail_eqpt

create or replace TABLE D_BRONZE.SADB.TRAIN_CNST_DTL_RAIL_EQPT (
	TRAIN_CNST_SMRY_ID NUMBER(18,0) NOT NULL,
	TRAIN_CNST_SMRY_VRSN_NBR NUMBER(4,0) NOT NULL,
	SQNC_NBR NUMBER(4,0) NOT NULL,
	RECORD_CREATE_TMS TIMESTAMP_NTZ(0),
	RECORD_UPDATE_TMS TIMESTAMP_NTZ(0),
	CREATE_USER_ID VARCHAR(32),
	UPDATE_USER_ID VARCHAR(32),
	MARK_CD VARCHAR(16),
	EQPUN_NBR VARCHAR(40),
	AAR_CAR_TYPE_CD VARCHAR(16),
	OTSD_LENGTH_FEET_QTY NUMBER(10,0),
	OTSD_LENGTH_INCHES_QTY NUMBER(10,0),
	TARE_WEIGHT_TONS_QTY NUMBER(10,2),
	ORIGIN_SCAC_CD VARCHAR(16),
	ORIGIN_FSAC_CD VARCHAR(20),
	ORIGIN_TRSTN_VRSN_NBR NUMBER(5,0),
	DSTNTN_SCAC_CD VARCHAR(16),
	DSTNTN_FSAC_CD VARCHAR(20),
	DSTNTN_TRSTN_VRSN_NBR NUMBER(5,0),
	CYCLE_SERIAL_NBR NUMBER(10,0),
	LOAD_EMPTY_IND VARCHAR(4),
	NET_WEIGHT_TONS_QTY NUMBER(10,0),
	CLRNC_PLATE_CD VARCHAR(4),
	BAD_ORDER_CAR_GRADE_CD VARCHAR(4),
	BAD_ORDER_REASON_CD VARCHAR(16),
	SHPPR_CPRS_CSTMR_ID VARCHAR(32),
	CNSGN_CPRS_CSTMR_ID VARCHAR(32),
	FSTWY_WYBL_NBR NUMBER(6,0),
	WYBL_TMS TIMESTAMP_NTZ(0),
	STCC_CD VARCHAR(28),
	HZCMD_MTRL_RSPNS_CD NUMBER(7,0),
	ON_JNCTN_SCAC_CD VARCHAR(16),
	ON_JNCTN_FSAC_CD VARCHAR(20),
	ON_JNCTN_TRSTN_VRSN_NBR NUMBER(5,0),
	RCVD_FROM_SCAC_CD VARCHAR(16),
	OFF_JNCTN_SCAC_CD VARCHAR(16),
	OFF_JNCTN_FSAC_CD VARCHAR(20),
	OFF_JNCTN_TRSTN_VRSN_NBR NUMBER(5,0),
	DLVR_TO_SCAC_CD VARCHAR(16),
	RFEQP_ASGN_NBR NUMBER(18,0),
	RFEQP_DATA_BASE_CN VARCHAR(8),
	SHPMT_NBR NUMBER(18,0),
	SHPMT_DATA_BASE_CN VARCHAR(8),
	ORNTN_CD VARCHAR(4),
	LEAD_LCMTV_IND VARCHAR(4),
	LCMTV_CNST_STATUS_CD VARCHAR(40),
	LCMTV_MCHNCL_STATUS_CD VARCHAR(40),
	BRNG_TYPE_CD VARCHAR(4),
	LIFT_MVMNT_EVENT_ID NUMBER(18,0),
	LIFT_EVENT_TMS TIMESTAMP_NTZ(0),
	LIFT_SCAC_CD VARCHAR(16),
	LIFT_FSAC_CD VARCHAR(20),
	LIFT_TRSTN_VRSN_NBR NUMBER(5,0),
	SET_MVMNT_EVENT_ID NUMBER(18,0),
	SET_EVENT_TMS TIMESTAMP_NTZ(0),
	SET_SCAC_CD VARCHAR(16),
	SET_FSAC_CD VARCHAR(20),
	SET_TRSTN_VRSN_NBR NUMBER(5,0),
	CNST_CHNG_EVENT_TMS TIMESTAMP_NTZ(0),
	CNST_CHNG_MVMNT_EVENT_ID NUMBER(18,0),
	CNST_CHNG_SCAC_CD VARCHAR(16),
	CNST_CHNG_FSAC_CD VARCHAR(20),
	CNST_CHNG_TRSTN_VRSN_NBR NUMBER(5,0),
	CARE_OF_PARTY_CPRS_CSTMR_ID VARCHAR(32),
	LIFT_RPRTNG_TM_ZN_CD VARCHAR(8),
	LIFT_RPRTNG_TM_ZN_YR_NBR NUMBER(4,0),
	SET_RPRTNG_TM_ZN_CD VARCHAR(8),
	SET_RPRTNG_TM_ZN_YR_NBR NUMBER(4,0),
	CNST_CHNG_RPRTNG_TM_ZN_CD VARCHAR(8),
	CNST_CHNG_RPRTNG_TM_ZN_YR_NBR NUMBER(4,0),
	INTRCH_MVMNT_ATHRTY_CD VARCHAR(8),
	OCS_UPDATE_CD VARCHAR(4),
	EQPMT_ASGNMN_ID NUMBER(18,0),
	SHPMT_ID NUMBER(18,0),
	CNST_LCM_OPRSTS_ID NUMBER(18,0),
	constraint PK_TRAIN_CNST_DTL_RAIL_EQPT_BASE_TRAIN_CNST_DTL_RAIL_EQPT_PK primary key (TRAIN_CNST_SMRY_ID, TRAIN_CNST_SMRY_VRSN_NBR, SQNC_NBR)
);


dm_dim.dim_location:

CREATE TABLE [DM_DIM].[DIM_LOCATION](
	[DIM_LOCATION_ID] [numeric](18, 0) NOT NULL,
	[EDW_CREATE_USER] [varchar](8) NULL,
	[EDW_CREATE_TMS] [datetime2](7) NULL,
	[EDW_UPDATE_USER] [varchar](8) NULL,
	[EDW_UPDATE_TMS] [datetime2](7) NULL,
	[SCAC_CD] [varchar](4) NULL,
	[FSAC_CD] [varchar](5) NULL,
	[SPLC_CD] [varchar](6) NULL,
	[STN_NM] [varchar](30) NULL,
	[STN_SEARCH_NM] [varchar](30) NULL,
	[UMBRL_STN_NM] [varchar](30) NULL,
	[GPLTCL_NM] [varchar](30) NULL,
	[LTD_NBR] [numeric](10, 8) NULL,
	[LNGTD_NBR] [numeric](11, 8) NULL,
	[BSNS_REASON_TXT] [varchar](80) NULL,
	[REGION_NM] [varchar](30) NULL,
	[DIVISION_NM] [varchar](50) NULL,
	[SUB_DIVISION_NM] [varchar](50) NULL,
	[CORRIDOR_NM] [varchar](50) NULL,
	[DYLGHT_SVNGS_TIME_IND] [varchar](1) NULL,
	[PHYSCL_CNTRY_CD] [varchar](2) NULL,
	[LOGICAL_CNTRY_CD] [varchar](2) NULL,
	[CITY_NM] [varchar](30) NULL,
	[LOCATION_EFCTV_DT] [datetime2](7) NULL,
	[LOCATION_EXPIRY_DT] [datetime2](7) NULL,
	[MSA_CD] [varchar](4) NULL,
	[POSTAL_ZIP_CD] [varchar](9) NULL,
	[RATE_POSTAL_ZIP_CD] [varchar](9) NULL,
	[RATE_ZIP_EFCTV_DT] [datetime2](7) NULL,
	[STPRV_CD] [varchar](2) NULL,
	[TIME_ZONE_CD] [varchar](2) NULL,
	[CREW_CHANGE_LCTN_IND] [varchar](1) NULL,
	[EQPMT_FLNG_LCTN_IND] [varchar](1) NULL,
	[EQPMT_INSPCT_LCTN_IND] [varchar](1) NULL,
	[CNTRL_STN_IND] [varchar](1) NULL,
	[ROAD_NBR] [numeric](3, 0) NULL,
	[SUBDIVISION] [varchar](50) NULL,
	[COUNTRY] [varchar](50) NULL,
	[REGION] [varchar](50) NULL,
	[DIVISION] [varchar](50) NULL,
	[ZONE] [varchar](50) NULL,
	[DIR_TERR] [varchar](50) NULL,
	[TERMINAL] [varchar](50) NULL,
	[CREW_TERMINAL] [varchar](50) NULL,
	[WORKLOAD_TERMINAL] [varchar](50) NULL,
	[FSAC_DWELL_IND] [varchar](1) NULL,
	[EW_REGIONS] [varchar](50) NULL,
	[TYES_CNTRL_STN] [varchar](50) NULL,
	[SHORTLINE_IND] [varchar](10) NULL,
	[MILE_POST] [numeric](18, 5) NULL,
	[COUNTY] [varchar](30) NULL,
	[ENG_DVSN] [varchar](20) NULL,
	[LMS_SUPPLY_NAME] [varchar](50) NULL,
	[LMS_SA] [varchar](10) NULL,
	[LCMTV_RESP_AREA] [varchar](20) NULL,
	[SBDVSN_ID] [numeric](4, 0) NULL,
	[RAIL_LINE] [varchar](4) NULL,
 CONSTRAINT [DIM_LOCATION1_PK] PRIMARY KEY CLUSTERED 
(
	[DIM_LOCATION_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO


dm_dim.dim_locomotive:

CREATE TABLE [DM_DIM].[DIM_LOCOMOTIVE](
	[DIM_LOCOMOTIVE_ID] [numeric](18, 0) NOT NULL,
	[EDW_CREATE_USER] [varchar](8) NULL,
	[EDW_CREATE_TMS] [datetime2](7) NULL,
	[EDW_UPDATE_USER] [varchar](8) NULL,
	[EDW_UPDATE_TMS] [datetime2](7) NULL,
	[EDW_START_EFCTV_DT] [datetime2](7) NULL,
	[EDW_END_EFCTV_DT] [datetime2](7) NULL,
	[EDW_CURRENT_FLG] [varchar](1) NULL,
	[MARK_CD] [varchar](4) NULL,
	[EQPUN_NBR] [varchar](10) NULL,
	[EIN_NBR] [varchar](10) NULL,
	[OTSD_LENGTH_QTY] [numeric](18, 0) NULL,
	[MODEL_NBR] [varchar](8) NULL,
	[AIR_BRAKE_MDL_NBR] [varchar](5) NULL,
	[AIR_BRAKE_HOOKP_CD] [varchar](1) NULL,
	[AXLE_QTY] [numeric](5, 0) NULL,
	[BLDR_CD] [varchar](1) NULL,
	[BRNG_TYPE_CD] [varchar](1) NULL,
	[FUEL_CPCTY_QTY] [numeric](5, 0) NULL,
	[FUEL_PRHTR_IND] [varchar](1) NULL,
	[FULL_WEIGHT_QTY] [numeric](10, 0) NULL,
	[HRSPWR_QTY] [numeric](5, 0) NULL,
	[MXM_SPEED_QTY] [numeric](5, 0) NULL,
	[TRCTN_MTR_TYPE_CD] [varchar](2) NULL,
	[DISTRIBUTED_POWER_IND] [varchar](1) NULL,
	[FUEL_TRIP_OPTIMIZER_IND] [varchar](1) NULL,
	[WHEEL_SIZE_QTY] [numeric](5, 0) NULL,
	[POWER_AXLE_QTY] [numeric](5, 0) NULL,
	[BRAKE_PIPE_PRSR_MNTNC_IND] [varchar](1) NULL,
	[AUXLRY_LUBE_OIL_CPCTY_QTY] [numeric](3, 0) NULL,
	[SRVC_CLASS_CD] [varchar](7) NULL,
	[CTGRY_CD] [varchar](3) NULL,
	[CNTNS_TRCTV_EFFORT_QTY] [numeric](2, 0) NULL,
	[COOL_SYSTEM_CPCTY_QTY] [numeric](3, 0) NULL,
	[ENGINE_MODEL_NM] [varchar](13) NULL,
	[GEAR_AXL_TEETH_QTY] [numeric](5, 0) NULL,
	[PNN_GEAR_TEETH_QTY] [numeric](5, 0) NULL,
	[GNRTR_MODEL_NM] [varchar](8) NULL,
	[MNTNC_HOME_SHOP_SCAC_CD] [varchar](4) NULL,
	[MNTNC_HOME_SHOP_FSAC_CD] [varchar](5) NULL,
	[LEASE_START_DT] [datetime2](7) NULL,
	[LEASE_END_DT] [datetime2](7) NULL,
	[WRNTY_SRVC_AGRMNT_CD] [varchar](8) NULL,
	[LCMTV_FRA_INSPECT_DT] [datetime2](7) NULL,
	[LCMTV_CTC_INSPECT_DT] [datetime2](7) NULL,
	[FLEET_ASGNMN_MARK_CD] [varchar](4) NULL,
	[SOURCE_SYSTEM_DELETE_TMS] [datetime2](7) NULL,
	[SAP_PTC_STATUS] [varchar](30) NULL,
	[SAP_OPERATOR] [varchar](30) NULL,
	[SAP_RR_CODE_OPERATOR] [varchar](30) NULL,
	[SAP_RR_CODE_OWNER] [varchar](30) NULL,
	[SAP_FLEET_ASGNMNT] [varchar](30) NULL,
	[SAP_BRAKE_SCHEDULE] [varchar](30) NULL,
	[SAP_AIR_FLOW_METER] [varchar](30) NULL,
	[SAP_SMART_START] [varchar](30) NULL,
	[SAP_HORSEPOWER] [numeric](18, 0) NULL,
	[SAP_SERVICE] [varchar](30) NULL,
	[SAP_SYSTEM_STATUS_TEXT] [varchar](30) NULL,
	[SAP_SYSTEM_STATUS] [varchar](4) NULL,
	[SAP_USER_STATUS_TEXT] [varchar](30) NULL,
	[SAP_USER_STATUS] [varchar](4) NULL,
	[SAP_AXLE_QUANTITY] [numeric](18, 0) NULL,
	[SAP_MODEL_NUMBER] [varchar](20) NULL,
	[SAP_MANUFACTURER] [varchar](30) NULL,
	[SAP_WEIGHT] [numeric](18, 5) NULL,
	[SAP_OBJ_NUMBER] [varchar](22) NULL,
	[SAP_PLANNING_PLANT] [varchar](4) NULL,
	[SAP_EQUIP_CATEGORY] [varchar](1) NULL,
	[SAP_LOCOMOTIVE] [varchar](25) NULL,
	[SAP_MAINTENANCE_PLANT] [varchar](4) NULL,
	[SAP_OBJ_TXT] [varchar](40) NULL,
	[SAP_CHAR_SERVICE] [varchar](30) NULL,
	[SAP_EQUIPMENT] [varchar](18) NULL,
	[SAP_VALID_FROM] [varchar](8) NULL,
	[SAP_VALID_TO] [varchar](8) NULL,
	[SAP_OBJ_TYPE] [varchar](10) NULL,
	[SAP_STATUS_INACT] [varchar](1) NULL,
	[SAP_CREATED_ON] [datetime2](7) NULL,
	[SAP_CHANGED_ON] [datetime2](7) NULL,
	[SAP_FUEL_CPCTY_CND] [varchar](30) NULL,
	[SAP_LUB_OIL_CPCTY_QTY] [varchar](30) NULL,
	[SAP_CAMERA_FRONT_IMAGE] [varchar](30) NULL,
	[SAP_LOCOTROL] [varchar](30) NULL,
	[SAP_CAMERA_DEPLOYMENT] [varchar](30) NULL,
	[SAP_CAMERA_CAB_IMAGE] [varchar](30) NULL,
	[BUILT_DT] [date] NULL,
	[RBLT_DT] [date] NULL,
	[MODEL_SHORT_NM] [varchar](6) NULL,
	[AC_FLEET] [varchar](10) NULL,
	[PSTV_TRAIN_CNTRL_SYSTEM_CD] [varchar](2) NULL,
	[PTC_STATUS] [varchar](2) NULL,
	[LVVR_IND] [varchar](1) NULL,
 CONSTRAINT [DIM_LOCOMOTIVE_PK] PRIMARY KEY CLUSTERED 
(
	[DIM_LOCOMOTIVE_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO


dim_equipment:

CREATE TABLE [DM_DIM].[DIM_EQUIPMENT](
	[DIM_EQUIPMENT_ID] [numeric](18, 0) NOT NULL,
	[EDW_SRC_BPK_MD5_ID] [varchar](32) NULL,
	[EDW_SRC_BK_MD5_ID] [varchar](32) NULL,
	[EDW_CREATE_USER] [varchar](8) NULL,
	[EDW_CREATE_TMS] [datetime2](7) NULL,
	[EDW_UPDATE_USER] [varchar](8) NULL,
	[EDW_UPDATE_TMS] [datetime2](7) NULL,
	[EDW_START_EFCTV_DT] [datetime2](7) NULL,
	[EDW_END_EFCTV_DT] [datetime2](7) NULL,
	[EDW_CURRENT_FLG] [varchar](1) NOT NULL,
	[EQPUN_NBR] [varchar](10) NOT NULL,
	[MARK_CD] [varchar](4) NOT NULL,
	[AAR_CAR_CD] [varchar](4) NOT NULL,
	[AAR_CAR_CD_ID] [numeric](18, 0) NULL,
	[EQPMNT_GROUP_CD] [varchar](4) NULL,
	[AXLE_QTY] [numeric](4, 0) NULL,
	[BUILT_DT] [datetime2](7) NULL,
	[DMTR_UOM_BASIS_CD] [varchar](2) NULL,
	[EIN_NBR] [varchar](10) NULL,
	[GROSS_WEIGHT_QTY] [numeric](7, 0) NULL,
	[GROSS_WEIGHT_UOM_BASIS_CD] [varchar](2) NULL,
	[LINEAL_FRCTNL_UOM_BASIS_CD] [varchar](2) NULL,
	[LINEAL_UOM_BASIS_CD] [varchar](2) NULL,
	[LIQUID_UOM_BASIS_CD] [varchar](2) NULL,
	[OTSD_EXTRM_HEIGHT_QTY] [numeric](4, 0) NULL,
	[OTSD_EXTRM_WIDTH_QTY] [numeric](4, 0) NULL,
	[OTSD_HEIGHT_EXTRM_WIDTH_QTY] [numeric](4, 0) NULL,
	[OTSD_LENGTH_QTY] [numeric](5, 0) NULL,
	[OWNER_MARK_CD] [varchar](4) NULL,
	[LESSEE_MARK_CD] [varchar](4) NULL,
	[PRIOR_EQPUN_NBR] [varchar](10) NULL,
	[PRIOR_MARK_CD] [varchar](4) NULL,
	[SPEED_UOM_BASIS_CD] [varchar](2) NULL,
	[STATUS_CD] [varchar](2) NULL,
	[SRVC_LIFE_CD] [varchar](2) NULL,
	[STNCL_MARK_OWNER_CLASS_CD] [varchar](2) NULL,
	[TARE_WEIGHT_QTY] [numeric](7, 0) NULL,
	[VOLUME_UOM_BASIS_CD] [varchar](2) NULL,
	[WEIGHT_UOM_BASIS_CD] [varchar](2) NULL,
	[MCHNCL_DSGNTN_CD] [varchar](4) NULL,
	[PLATE_CLRNC_CD] [varchar](2) NULL,
	[RBLT_CD] [varchar](1) NULL,
	[RBLT_DT] [datetime2](7) NULL,
	[RATE_CD] [varchar](2) NULL,
	[CAR_OWNERSHIP] [varchar](15) NULL,
	[LEASED_IND] [varchar](10) NULL,
	[TARGET_EQPMT_CTGRY_NM] [varchar](30) NULL,
	[PRDCT_NM] [varchar](30) NULL,
	[FLEET_NM] [varchar](50) NULL,
	[EQPMNT_POOL_ID] [numeric](18, 0) NULL,
	[FLEET_SBGRP_CTGRY_NM] [varchar](30) NULL,
	[PARTY_NM] [varchar](100) NULL,
	[CAR_KIND_CD] [varchar](30) NULL,
	[UCA_CODES] [varchar](10) NULL,
	[CPR_EQPMNT_POOL_ID] [varchar](7) NULL,
	[AAR_EQPMNT_POOL_ID] [varchar](7) NULL,
	[EFCTV_TMS] [datetime2](7) NULL,
	[MAX_EFCTV_TMS] [datetime2](7) NULL,
	[REGISTERED_IND] [varchar](1) NOT NULL,
	[CP_OWNED_IND] [varchar](1) NULL,
	[DLTD_TMS] [datetime2](7) NULL,
 CONSTRAINT [DIM_EQUIPMENT_PK] PRIMARY KEY CLUSTERED 
(
	[DIM_EQUIPMENT_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO


